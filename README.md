# ARP and DNS Spoofing Lab README

This repo contains the scripts and data from the assignment. The goal of the lab was to build and test tools that demonstrate how ARP spoofing and DNS spoofing can be used to intercept and manipulate network traffic.  Evidence from each task is included.

## Contents

* **`arp_spoof.py`** – A scrapy-based ARP cache poisoning tool.  It forges ARP replies to bind the attacker’s MAC address to the victim’s or gateway’s IP address, which enables MITM position. 

* **`traffic_interceptor.py`** – A helper script that parses `pcap` files using `tshark`.  It extracts HTTP requests, DNS queries, top talkers and protocol counts from a capture and writes them to CSV files.  See the `analysis` sub‑folder under `evidence/task2` for sample output.

* **`dns_spoof.py`** – A selective DNS spoofer.  It listens for DNS queries on a specified interface, checks the queried name against the whitelist/blacklist in `targets.txt`, and sends a forged reply that points to an attacker‑controlled IP address.

* **`targets.txt`** – List of domain names to spoof, one per line.

* **`fake_www/`** – Contains a minimal `index.html` used as the fake web site served by the attacker when a victim is redirected.

* **`pcap_files/`** – All packet captures from the experiments.  Files are prefixed with the task they belong to (e.g. `task1_victim_before_and_during_arp.pcap`).

* **`evidence/`** – Screenshots and logs collected during the experiments.  Subdirectories group evidence by task.  The `evidence/task2/analysis` folder holds CSV summaries generated by `traffic_interceptor.py`.

* **`requirements.txt`** – Python package requirements for the scripts.

## Usage

The scripts require root privileges to run.  Use `sudo` when executing them.

### Task 1: ARP spoofing

```bash
sudo python3 arp_spoof.py <victim_ip> <gateway_ip> -i <interface> [-v] [--no-forward]
```

Arguments:

* `victim_ip` – IP address of the victim host.
* `gateway_ip` – IP address of the network’s default gateway.
* `-i, --interface` – network interface on which to send ARP packets.
* `-v, --verbose` – print a running count of packets sent.
* `--no-forward` – disable IP forwarding.

The tool will continue poisoning the ARP caches until interrupted.  Press Ctrl+C to stop.

### Task 2: Traffic parsing

```bash
python3 traffic_interceptor.py
```

The parser expects a capture named `all_traffic.pcap` inside a directory called `pcap_files/task2` in your home directory (i.e. `~/assignment/pcap_files/task2`).  It writes its CSV outputs to an `analysis` folder next to the PCAP.

### Task 3: DNS spoofing

```bash
sudo python3 dns_spoof.py -i <interface> -t targets.txt --fake-ip <attacker_ip> [--forward] [--upstream <dns_ip>]
```

Arguments:

* `-i, --iface` – interface to listen on.
* `-t, --targets` – path to a file containing domain names to spoof.
* `--fake-ip` – IP address that should be returned in forged DNS responses.
* `--forward` – forward unmatched queries to an upstream resolver and relay the response.
* `--upstream` – IP address of the DNS server when forwarding.

When a DNS query for a listed domain is seen, the script sends a spoofed reply with the provided fake IP.  When forwarding is enabled, legitimate queries are forwarded to the upstream server and the real answer is relayed back to the client.

## Evidence and analysis

All the evidence and screenshots colloected are stored under the `evidence/` directory.  Each subdirectory corresponds to a task (`task1`, `task2`, `task3`) and contains images and text files captured during the experiments.  The `pcap_files/` directory contains all raw capture files from the lab.

## Requirements

These scripts were created for Python 3. The `requirements.txt` file lists the necessary Python packages. Parsing the traffic requires `tshark` and `tcpdump` to be installed on your system and root privileges. For DNS spoofing demonstrations, a local DNS resolver (like `dnsmasq`) and a simple HTTP server to serve the `fake_www` directory are also needed.

## Disclaimer

Note that this README used GitHub copilot to help paraphrase some sentences within this file. Additionally, the code provided in this repository is for educational purposes only.  Always obtain proper authorization before testing or deploying any network security tools.  Misuse of these tools can lead to legal consequences and network disruptions.  The author is not responsible for any damage or legal issues arising from the use of this code.
